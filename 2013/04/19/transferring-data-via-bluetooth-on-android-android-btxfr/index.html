<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width">
    <title>Transferring Data via Bluetooth on Android (android-btxfr) - simonguest.com
    </title>
    <link rel="alternate" href="http://localhost:8080/feed.xml" type="application/rss+xml" title="The only person allowed to login as 'guest'">
    <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic|Anonymous+Pro:400,700,400italic,700italic|Merriweather:400,700,300">
    <link rel="stylesheet" href="/css/main.css">
  </head>
  <body class="article-detail">
    <header class="header">
      <div class="content-wrap">
        <h1>Transferring Data via Bluetooth on Android (android-btxfr)</h1>
        <p class="author">Written by <span class="author">Simon Guest</span>
        </p>
      </div>
    </header>
    <div id="content">
      <div class="content-wrap">
        <article class="article">
          <section class="content"><p>Recently, I’ve been working on some code to transfer images and other data between Android devices using Bluetooth.  While I could have used the Basic Imaging Profile (<span class="caps">BIP</span>) of the Bluetooth 4.0 specification, this particular application has specific requirements that would have been difficult to implement using BIP.  To overcome this, I ended up building an application that instead relies on the Serial Port Profile (SPP), exchanging data using the RFCOMM&nbsp;protocol.  </p>
<p><span class="more"></span></p>
<p>The <span class="caps">SPP</span> implementation on Android is nice, but only offers the fundamentals of an InputStream and OutputStream.  While this provides the basics of sending and receiving bytes, it doesn’t handle data integrity, progress updates, threading, or any of the other requirements often needed when sending data between two&nbsp;devices.</p>
<p>The result from my recent work is an Android library called <a href="http://github.com/simonguest/android-btxfr">android-btxfr</a>, which I’m happy to share through my Github repository.  android-btxfr is lightweight library designed to send and receive any type of data between Android (<span class="caps">API</span> 15 and higher).  It can be used to exchange text, files, photos, videos, sounds, and literally any other type of binary data.  The library supports anything that can be put into a byte stream and includes digest checking to ensure data&nbsp;integrity.</p>
<p>The library exposes two thread types (ClientThread and ServerThread) depending on whether you are sending or receiving&nbsp;data.</p>
<p>Receiving data is easy. Simply run the server thread, passing the paired bluetooth device and handler. The handler will be then called with the following&nbsp;messages:</p>
<p><strong>DATA_PROGRESS_UPDATE</strong> - Data is being received by the other device. The message contains the progress of the data being received.
<strong>DATA_RECEIVED</strong> - Data has been fully received from the other device. The message will contain the actual payload (a byte stream of the image, video,&nbsp;etc.)</p>
<p>There are other message types to handle failure&nbsp;conditions.</p>
<p>The client thread works in a similar fashion. To send data, invoke the client thread, passing the paired bluetooth device and handler. The handler will be called with the following&nbsp;messages:</p>
<p><strong>READY_FOR_DATA</strong> - Indicates that the connection has been established, and data can be sent.
<strong>SENDING_DATA</strong> - Indicates that data is being sent to the other device.
<strong>DATA_SENT_OK</strong> - Indicates that the recipient received the&nbsp;payload.</p>
<p>Again, there are other message types to handle&nbsp;failures.</p>
<p>To show all of this in action, I’ve put together a sample application, which can be found <a href="http://github.com/simonguest/btphototransfer-sample">here</a>.  This app uses the android-btxfr library to send captured photos between&nbsp;devices. </p>
<p><img src="/articles/transferring-data-via-bluetooth-on-android-android-btxfr/sending.png" alt="Sending a Photo">
<img src="/articles/transferring-data-via-bluetooth-on-android-android-btxfr/receiving.png" alt="Receiving a Photo"></p>
</section>
        </article>
      </div>
    </div>
    <footer>
      <div class="content-wrap">
        <div class="nav"><a href="/">« Full blog</a></div>
        <section class="about"><p>Simon Guest is the VP of Platform R&amp;D at Concur Technologies, passionate about software engineering, API design, and developer experience.</p>
<p>Simon is a certified IT Architect (CITA-P), a member of the British Computer Society (MBCS), was named as one of “Microsoft’s Key Employee Losses of 2010″ by eWeek, and has been awarded a place on Sun Microsystems’ “Speaker Wall of Fame” on two occasions.</p>
<p>In addition to speaking, Simon enjoys writing, is the author of numerous articles, patents, and books, and maintains an active blog at <a href="http://simonguest.com">http://simonguest.com</a>.</p>
<p>You can get in touch with Simon through <a href="http://linkedin.com/pub/simonguest">LinkedIn</a></p>

        </section>
        <section class="copy">
          <p>&copy; 2014 Simon Guest &mdash; powered by&nbsp;<a href="https://github.com/jnordberg/wintersmith">Wintersmith</a>
            <script type="text/javascript">
              (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
              ga('create', 'UA-56671816-1', 'auto');
              ga('send', 'pageview');
              
            </script>
          </p>
        </section>
      </div>
    </footer>
  </body>
</html>